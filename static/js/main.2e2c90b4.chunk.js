(this["webpackJsonpthrill-digger-react"]=this["webpackJsonpthrill-digger-react"]||[]).push([[0],{11:function(e,t,n){"use strict";(function(e){var r=n(13),i=n(4),a=n(5),c=n(3),o=n(7),l=n(6),s=n(1),u=n.n(s),d=(n(22),n(2)),b=n(0),h=function(t){Object(o.a)(u,t);var s=Object(l.a)(u);function u(e){var t;return Object(i.a)(this,u),(t=s.call(this,e)).state={nativeModule:null,currentMessage:"waiting to initialize...",solver:null,cellStates:[{bombPercentage:0,selectedType:d.b.Unspecified,ranking:100}],boardHeight:0,boardWidth:0},t.selectedChanged=t.selectedChanged.bind(Object(c.a)(t)),t}return Object(a.a)(u,[{key:"componentDidMount",value:function(){var t=this;n.e(3).then(n.bind(null,32)).then((function(n){t.setState({nativeModule:n,currentMessage:"computing values...",solver:n.create_solver(2)}),e((function(){var e;console.log("setting state"),null===(e=t.state.solver)||void 0===e||e.cache_boards();var n=t.state.solver.get_height(),r=t.state.solver.get_width(),i=Array(n*r).fill(0).map((function(){return{bombPercentage:0,selectedType:d.b.Unspecified,ranking:100}}));t.setState({currentMessage:"done!",boardWidth:r,boardHeight:n,cellStates:i}),t.updateBoardAndRecalculateProbs(i)}))}))}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.state.solver)||void 0===e||e.free()}},{key:"getSolverOrError",value:function(){if(null===this.state.solver)throw Error("solver is null!");return this.state.solver}},{key:"selectedChanged",value:function(e,t){var n=this.state.cellStates;n[e].selectedType=t,this.getSolverOrError().set_hole(e,t),this.updateBoardAndRecalculateProbs(n)}},{key:"updateBoardAndRecalculateProbs",value:function(e){var t=this.getSolverOrError();t.calculate_probabilities_with_pregenerated(),e.forEach((function(e,n){e.bombPercentage=t.get_probability(n)}));var n=e.filter((function(e){return e.selectedType===d.b.Unspecified})).map((function(e,t){return[t,e]}));n.sort((function(e,t){return e[1].bombPercentage-t[1].bombPercentage})),n.forEach((function(e,t){var n=Object(r.a)(e,2);n[0];return n[1].ranking=t})),e.forEach((function(e){e.selectedType!==d.b.Unspecified&&(e.ranking=100)})),this.setState({cellStates:e})}},{key:"resetBoard",value:function(){for(var e,t,n=(null===(e=this.state.solver)||void 0===e?void 0:e.get_height())||0,r=(null===(t=this.state.solver)||void 0===t?void 0:t.get_width())||0,i=Array(n*r).fill(0).map((function(){return{bombPercentage:0,selectedType:d.b.Unspecified,ranking:100}})),a=this.getSolverOrError(),c=0;c<n*r;c++)a.set_hole(c,d.b.Unspecified);this.updateBoardAndRecalculateProbs(i)}},{key:"render",value:function(){var e=this,t=this.state,n=t.boardHeight,r=t.boardWidth,i=t.cellStates,a=t.currentMessage;return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("h1",{children:"Thrill Digger Expert solver"}),Object(b.jsx)("div",{children:a}),Object(b.jsx)("table",{children:Object(b.jsx)("tbody",{children:Array(n).fill(0).map((function(t,n){return Object(b.jsx)("tr",{children:Array(r).fill(0).map((function(t,a){var c=n*r+a,o=i[c];return Object(b.jsx)("td",{children:Object(b.jsx)(d.a,{bombProbability:o.bombPercentage,selectedState:o.selectedType,index:c,selectionChangedCallback:e.selectedChanged,ranking:o.ranking},c)})}))})}))})}),Object(b.jsx)("button",{onClick:this.resetBoard.bind(this),children:"Reset"}),Object(b.jsxs)("div",{children:["Source code: ",Object(b.jsx)("a",{href:"https://github.com/lepelog/thrill-digger",children:"GitHub"})]})]})}}]),u}(u.a.Component);t.a=function(){return Object(b.jsx)(h,{})}}).call(this,n(19).setImmediate)},18:function(e,t,n){},2:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return g}));var r,i=n(4),a=n(5),c=n(3),o=n(7),l=n(6),s=n(1),u=n.n(s),d=n(12),b=n.n(d),h=(n(29),n(0));!function(e){e[e.Unspecified=0]="Unspecified",e[e.GreenRupee=1]="GreenRupee",e[e.BlueRupee=2]="BlueRupee",e[e.RedRupee=3]="RedRupee",e[e.SilverRupee=4]="SilverRupee",e[e.GoldRupee=5]="GoldRupee",e[e.Rupoor=6]="Rupoor",e[e.Bomb=7]="Bomb"}(r||(r={}));var p=[r.Unspecified,r.GreenRupee,r.BlueRupee,r.RedRupee,r.SilverRupee,r.GoldRupee,r.Rupoor,r.Bomb],v=b()(["#2de500","#e5d200","#e50b00"]),g=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).onSelectChange=r.onSelectChange.bind(Object(c.a)(r)),r}return Object(a.a)(n,[{key:"onSelectChange",value:function(e){this.props.selectionChangedCallback(this.props.index,parseInt(e.target.value))}},{key:"render",value:function(){var e=this.props,t=e.bombProbability,n=e.index,i=e.selectedState,a=e.ranking,c=i===r.Unspecified?v(isFinite(t)?t:0):"unset";return Object(h.jsxs)("div",{className:"grid-field",style:{backgroundColor:c,borderColor:a<3?"#0011d3":"black"},children:[Object(h.jsxs)("div",{children:["hole: ",n,", probability: ",(100*t).toFixed(2),"%"]}),Object(h.jsx)("div",{children:Object(h.jsx)("select",{onChange:this.onSelectChange,value:i,children:p.map((function(e){return Object(h.jsx)("option",{value:e,children:(t=e,r[t])},e);var t}))})})]})}}]),n}(u.a.Component)},22:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(10),c=n.n(a),o=(n(18),n(11)),l=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,36)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),i(e),a(e),c(e)}))},s=n(0);c.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(o.a,{})}),document.getElementById("root")),l()}},[[31,1,2]]]);
//# sourceMappingURL=main.2e2c90b4.chunk.js.map